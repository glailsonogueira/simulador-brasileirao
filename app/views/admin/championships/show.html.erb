<%= breadcrumb ["Início", root_path], ["Admin", admin_championships_path], @championship.full_name %>

<h1><%= @championship.full_name %></h1>

<%= link_to "← Voltar", admin_championships_path, class: "btn", style: "margin-bottom: 20px;" %>
<%= link_to "Editar", edit_admin_championship_path(@championship), class: "btn", style: "margin-bottom: 20px;" %>

<div class="card">
  <h2>Informações</h2>
  <p><strong>Ano:</strong> <%= @championship.year %></p>
  <p><strong>Status:</strong> <%= @championship.active? ? "Ativo" : "Inativo" %></p>
  <p><strong>Data Início:</strong> <%= @championship.start_date&.strftime("%d/%m/%Y") %></p>
  <p><strong>Data Fim:</strong> <%= @championship.end_date&.strftime("%d/%m/%Y") %></p>
  <p><strong>Clubes:</strong> <%= @championship.clubs_count %>/20</p>
  <p><strong>Rodadas:</strong> <%= @championship.rounds.count %></p>
</div>

<div class="card">
  <h2>Clubes Participantes (<%= @championship.clubs_count %>/20)</h2>
  
  <% if @championship.can_add_club? %>
    <div style="margin-bottom: 20px;">
      <%= form_with url: admin_championship_add_club_path(@championship), method: :post, local: true do |f| %>
        <%= select_tag :club_id, options_from_collection_for_select(Club.where.not(id: @championship.clubs.pluck(:id)).ordered, :id, :name), prompt: "Selecione um clube", style: "padding: 10px; margin-right: 10px;" %>
        <%= f.submit "Adicionar Clube", class: "btn" %>
      <% end %>
    </div>
  <% end %>
  
  <% if @championship.clubs.any? %>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Sigla</th>
          <th>Especial</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <% @championship.clubs.ordered.each do |club| %>
          <tr>
            <td><%= club.name %></td>
            <td><%= club.abbreviation %></td>
            <td><%= club.special_club? ? "★" : "-" %></td>
            <td>
              <%= button_to "Remover", admin_championship_remove_club_path(@championship, club_id: club.id), method: :delete, data: { confirm: "Tem certeza?" }, class: "btn btn-danger", style: "padding: 5px 10px; font-size: 12px;" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p>Nenhum clube adicionado ainda.</p>
  <% end %>
  
  <% if @championship.complete? && @championship.rounds.count == 0 %>
    <div style="margin-top: 20px;">
      <%= button_to "Gerar 38 Rodadas", generate_rounds_admin_championship_path(@championship), method: :post, class: "btn", style: "background: #28a745;", data: { confirm: "Gerar 38 rodadas agora?" } %>
    </div>
  <% end %>
</div>

<% if @championship.rounds.any? %>
  <div class="card">
    <h2>Rodadas</h2>
    <% @championship.rounds.order(:number).each do |round| %>
      <div style="margin: 10px 0;">
        <%= link_to "Rodada #{round.number}", admin_round_matches_path(round), class: "btn", style: "margin: 2px;" %>
        <%= link_to "Resultados", admin_round_results_path(round), class: "btn", style: "margin: 2px; background: #28a745;" %>
      </div>
    <% end %>
  </div>
<% end %>
