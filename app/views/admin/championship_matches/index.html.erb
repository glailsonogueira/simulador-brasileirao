<% content_for :title, "Jogos e Resultados - #{@championship.full_name}" %>
<%= breadcrumb [t("navigation.home"), root_path], ["Admin", admin_championships_path], [t("navigation.championships"), admin_championships_path], [@championship.full_name, admin_championship_path(@championship)], "Jogos e Resultados" %>

<div style="text-align: center; margin-bottom: 30px;">
  <h1 style="color: #000080;">⚽ Jogos e Resultados</h1>
  <p style="font-size: 18px; color: #666; margin-top: 10px;">
    <strong><%= @championship.full_name %></strong>
  </p>
  <div style="margin-top: 15px;">
    <%= link_to t("actions.back_to_championship"), admin_championship_path(@championship), class: "btn" %>
  </div>
</div>

<% if @rounds.any? %>
  <div class="card">
    <h2 style="text-align: center; margin-bottom: 20px;">Rodadas (<%= @rounds.count %>)</h2>
    
    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; margin-top: 20px;">
      <% @rounds.each do |round| %>
        <% matches_count = round.matches.count %>
        <% finished_count = round.matches.where(finished: true).count %>
        <% all_finished = matches_count > 0 && round.finished? %>
        <% no_matches = matches_count == 0 %>
        <% has_ongoing = matches_count > 0 && finished_count > 0 && !all_finished %>
        
        <%# Definir cor de fundo do card %>
        <% if all_finished %>
          <% bg_color = '#d4edda' %>  <%# Verde claro - Todos finalizados %>
          <% border_color = '#28a745' %>
        <% elsif has_ongoing %>
          <% bg_color = '#d1ecf1' %>  <%# Azul claro - Jogos em andamento %>
          <% border_color = '#17a2b8' %>
        <% elsif no_matches %>
          <% bg_color = '#fff3cd' %>  <%# Amarelo claro - Sem jogos %>
          <% border_color = '#ffc107' %>
        <% else %>
          <% bg_color = '#f8f9fa' %>  <%# Cinza claro - Nenhum jogo finalizado ainda %>
          <% border_color = '#ddd' %>
        <% end %>
        
        <div class="card" style="background: <%= bg_color %>; text-align: center; padding: 20px; border: 2px solid <%= border_color %>;">
          <h3 style="color: #000080; margin-bottom: 15px; font-size: 20px;">
            Rodada <%= round.number %>
            <% if all_finished %>
              <span style="color: #28a745; font-size: 16px;">✅</span>
            <% elsif has_ongoing %>
              <span style="color: #17a2b8; font-size: 16px;">⚽</span>
            <% elsif no_matches %>
              <span style="color: #ffc107; font-size: 16px;">⚠️</span>
            <% end %>
          </h3>
          
          <div style="display: flex; flex-direction: column; gap: 10px;">
            <%= link_to t("labels.matches"), matches_admin_round_path(round), class: "btn", style: "width: 100%;" %>
            <%= link_to t("labels.results"), results_admin_round_path(round), class: "btn", style: "width: 100%; background: #28a745;" %>
          </div>
          
          <div style="margin-top: 15px; font-size: 12px; color: #666;">
            <% if no_matches %>
              <p style="color: #856404; font-weight: bold;">⚠️ Sem jogos cadastrados</p>
            <% else %>
              <p><strong><%= matches_count %></strong> partida(s)</p>
              <% if all_finished %>
                <p style="color: #28a745; font-weight: bold;">
                  <%= finished_count %> finalizada(s) ✅
                </p>
              <% elsif finished_count > 0 %>
                <p style="color: #17a2b8; font-weight: bold;">
                  <%= finished_count %>/<%= matches_count %> finalizada(s) ⚽
                </p>
              <% else %>
                <p style="color: #6c757d;">Nenhuma finalizada</p>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% else %>
  <div class="card">
    <p style="text-align: center; color: #999; padding: 40px;">
      Nenhuma rodada criada ainda.
      <% if @championship.complete? %>
        <br><br>
        <%= button_to t("actions.generate_38_rounds"), generate_rounds_admin_championship_path(@championship), method: :post, class: "btn", style: "background: #28a745;", data: { confirm: "Gerar 38 rodadas vazias?" } %>
      <% end %>
    </p>
  </div>
<% end %>

<!-- Responsividade -->
<style>
  @media (max-width: 1200px) {
    div[style*="grid-template-columns: repeat(5, 1fr)"] {
      grid-template-columns: repeat(4, 1fr) !important;
    }
  }
  
  @media (max-width: 992px) {
    div[style*="grid-template-columns: repeat(5, 1fr)"],
    div[style*="grid-template-columns: repeat(4, 1fr)"] {
      grid-template-columns: repeat(3, 1fr) !important;
    }
  }
  
  @media (max-width: 768px) {
    div[style*="grid-template-columns"] {
      grid-template-columns: repeat(2, 1fr) !important;
    }
  }
  
  @media (max-width: 480px) {
    div[style*="grid-template-columns"] {
      grid-template-columns: 1fr !important;
    }
  }
</style>